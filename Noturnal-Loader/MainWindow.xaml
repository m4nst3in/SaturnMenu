<Window x:Class="Noturnal.Loader.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Noturnal" Height="650" Width="950"
        WindowStartupLocation="CenterScreen" ResizeMode="CanMinimize" 
        WindowStyle="None" AllowsTransparency="True" Background="Transparent">

    <!-- Borda Principal com Recorte (Clip) e Fundo Cyber -->
    <Border Background="{StaticResource Brush.CyberBackground}" 
            CornerRadius="16" 
            BorderBrush="{StaticResource Brush.Outline}" 
            BorderThickness="1" 
            ClipToBounds="True">
        <Grid>
            <!-- EFEITO DE FUNDO (Grid + Luz) -->
            <!-- Mantido local pois é decoração específica desta janela -->
            <Grid IsHitTestVisible="False" Opacity="0.2">
                <Grid.Background>
                    <DrawingBrush TileMode="Tile" Viewport="0,0,50,50" ViewportUnits="Absolute">
                        <DrawingBrush.Drawing>
                            <GeometryDrawing>
                                <GeometryDrawing.Pen>
                                    <Pen Brush="#3A4055" Thickness="0.5"/>
                                </GeometryDrawing.Pen>
                                <GeometryDrawing.Geometry>
                                    <GeometryGroup>
                                        <LineGeometry StartPoint="0,0" EndPoint="0,50"/>
                                        <LineGeometry StartPoint="0,0" EndPoint="50,0"/>
                                    </GeometryGroup>
                                </GeometryDrawing.Geometry>
                            </GeometryDrawing>
                        </DrawingBrush.Drawing>
                    </DrawingBrush>
                </Grid.Background>
                <Grid.OpacityMask>
                    <RadialGradientBrush Center="0.5,0.4" RadiusX="0.8" RadiusY="1">
                        <GradientStop Color="Black" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Grid.OpacityMask>
            </Grid>

            <!-- Luz Ambiente no Topo -->
            <Border VerticalAlignment="Top" Height="200" Margin="-100,-100,-100,0" Opacity="0.15" IsHitTestVisible="False">
                <Border.Background>
                    <RadialGradientBrush Center="0.5,0">
                        <GradientStop Color="{StaticResource Color.Primary}" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Border.Background>
            </Border>

            <!-- LAYOUT PRINCIPAL -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="260"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- SIDEBAR -->
                <Border Grid.Column="0" Background="#05FFFFFF" BorderBrush="{StaticResource Brush.Outline}" BorderThickness="0,0,1,0">
                    <Grid Margin="24,32,24,32">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Logo -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,40">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <Viewbox Width="32" Height="32" Margin="0,0,12,0">
                                    <Path Data="M12,2 L2,22 L22,22 Z" Fill="{StaticResource Brush.NoturnalTitleGradient}" Stretch="Uniform"/>
                                </Viewbox>
                                <TextBlock Text="NOTURNAL" FontSize="24" FontWeight="Bold" Foreground="White" VerticalAlignment="Center">
                                    <TextBlock.Effect>
                                        <DropShadowEffect Color="{StaticResource Color.Primary}" BlurRadius="20" ShadowDepth="0" Opacity="0.4"/>
                                    </TextBlock.Effect>
                                </TextBlock>
                            </StackPanel>
                            <TextBlock Text="KERNEL SOLUTIONS" FontSize="10" Foreground="{StaticResource Brush.TextSecondary}" Margin="44,-4,0,0" Opacity="0.7"/>
                        </StackPanel>

                        <!-- Menu de Navegação (Usa estilo NavButton do Themes) -->
                        <StackPanel Grid.Row="1">
                            <TextBlock Text="MENU" FontSize="11" FontWeight="Bold" Foreground="{StaticResource Brush.TextDisabled}" Margin="12,0,0,12"/>
                            
                            <Button Tag="Injector" Style="{StaticResource NavButton}" Command="{Binding NavigateInjectorCommand}" IsEnabled="{Binding IsLoggedIn}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE718;" FontSize="18" Width="24" TextAlignment="Center"/>
                                    <TextBlock Text="Dashboard" FontSize="14" VerticalAlignment="Center" Margin="12,0,0,0" FontWeight="SemiBold"/>
                                </StackPanel>
                            </Button>

                            <Button Tag="Website" Style="{StaticResource NavButton}" Command="{Binding NavigateWebsiteCommand}" IsEnabled="{Binding IsLoggedIn}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE774;" FontSize="18" Width="24" TextAlignment="Center"/>
                                    <TextBlock Text="Cloud Web" FontSize="14" VerticalAlignment="Center" Margin="12,0,0,0" FontWeight="SemiBold"/>
                                </StackPanel>
                            </Button>

                            
                        </StackPanel>

                        <!-- User Profile -->
                        <Border Grid.Row="2" Background="#0DFFFFFF" CornerRadius="12" Padding="12" BorderBrush="{StaticResource Brush.Outline}" BorderThickness="1">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Ellipse Width="36" Height="36">
                                    <Ellipse.Fill>
                                        <ImageBrush ImageSource="Assets/logo.png" Stretch="UniformToFill"/>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <StackPanel Grid.Column="1" Margin="12,0,0,0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding CurrentUser.DisplayName, TargetNullValue=Guest}" FontSize="13" FontWeight="Bold" Foreground="White"/>
                                    <TextBlock Text="Lifetime" FontSize="11" Foreground="{StaticResource Brush.Success}"/>
                                </StackPanel>
                                <!-- Ícone de Logout -->
                                <Button Grid.Column="2" Style="{StaticResource LinkButton}" Padding="4" Command="{Binding LogoutCommand}">
                                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE7E8;" FontSize="16"/>
                                </Button>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>

                <!-- ÁREA DE CONTEÚDO -->
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="50"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Barra de Título (Drag Area) -->
                    <Border Grid.Row="0" x:Name="TitleBar" Background="Transparent">
                        <Grid Margin="24,0">
                            <!-- Breadcrumb / Título da Aba -->
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Opacity="0.6">
                                <TextBlock Text="NOTURNAL" Foreground="{StaticResource Brush.TextSecondary}" FontSize="12"/>
                                <TextBlock Text="/" Foreground="{StaticResource Brush.TextSecondary}" Margin="8,0"/>
                                <TextBlock Text="{Binding SelectedTab}" Foreground="White" FontWeight="SemiBold" FontSize="12"/>
                            </StackPanel>

                            <!-- Botões de Janela -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                                <Button Content="&#xE921;" FontFamily="Segoe MDL2 Assets" Click="Minimize_Click" Style="{StaticResource LinkButton}" Height="30" Width="30"/>
                                <Button Content="&#xE8BB;" FontFamily="Segoe MDL2 Assets" Click="Close_Click" Style="{StaticResource LinkButton}" Height="30" Width="30" Foreground="#FF5252"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Frame onde as Páginas Carregam -->
                    <Grid Grid.Row="1" Margin="32,0,32,32">
                        <Frame x:Name="MainFrame" NavigationUIVisibility="Hidden"/>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>