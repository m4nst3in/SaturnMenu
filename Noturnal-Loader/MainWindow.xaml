<Window x:Class="Noturnal.Loader.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="Noturnal" Height="600" Width="800" WindowStartupLocation="CenterScreen" ResizeMode="CanMinimize" WindowStyle="None" UseLayoutRounding="True" SnapsToDevicePixels="True" Background="{StaticResource Brush.Background}">
    <Grid>
        <!-- Main Layout: Sidebar + Content -->
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar Background -->
        <Border Grid.Column="0" Background="{StaticResource Brush.Surface}">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.15" BlurRadius="8" ShadowDepth="0"/>
            </Border.Effect>
        </Border>

        <!-- Sidebar Content -->
        <Grid Grid.Column="0" Margin="24,24,24,32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Logo Section -->
            <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,32">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,16">
                    <Image Source="Assets/logo.png" Width="48" Height="48" Margin="0,0,12,0" RenderOptions.BitmapScalingMode="HighQuality" Stretch="Uniform"/>
                    <TextBlock Text="Noturnal" FontSize="28" FontWeight="Bold" Foreground="{StaticResource Brush.NoturnalTitleGradient}" VerticalAlignment="Center"/>
                </StackPanel>
                
                <Border Height="1" Background="{StaticResource Brush.Outline}" Margin="-4,0,-4,0"/>
            </StackPanel>

            <!-- Navigation Menu -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel Orientation="Vertical">
                    <Button Tag="Injector" Style="{StaticResource NavButton}" Command="{Binding NavigateInjectorCommand}" IsEnabled="{Binding IsLoggedIn}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE896;" FontSize="20" Width="24" TextAlignment="Center"/>
                            <TextBlock Text="Injector" FontSize="14" VerticalAlignment="Center" Margin="12,0,0,0"/>
                        </StackPanel>
                    </Button>

                    <Button Tag="Website" Style="{StaticResource NavButton}" Command="{Binding NavigateWebsiteCommand}" IsEnabled="{Binding IsLoggedIn}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE774;" FontSize="20" Width="24" TextAlignment="Center"/>
                            <TextBlock Text="Website" FontSize="14" VerticalAlignment="Center" Margin="12,0,0,0"/>
                        </StackPanel>
                    </Button>

                    <Button Tag="Settings" Style="{StaticResource NavButton}" Command="{Binding NavigateConfigCommand}" IsEnabled="{Binding IsLoggedIn}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE713;" FontSize="20" Width="24" TextAlignment="Center"/>
                            <TextBlock Text="Settings" FontSize="14" VerticalAlignment="Center" Margin="12,0,0,0"/>
                        </StackPanel>
                    </Button>

                    <Button Tag="Support" Style="{StaticResource NavButton}" Command="{Binding NavigateSupportCommand}" IsEnabled="{Binding IsLoggedIn}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE897;" FontSize="20" Width="24" TextAlignment="Center"/>
                            <TextBlock Text="Support" FontSize="14" VerticalAlignment="Center" Margin="12,0,0,0"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </ScrollViewer>

            <!-- User Profile Section -->
            <Border Grid.Row="2" Style="{StaticResource CardBorder}" Padding="12">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Ellipse Width="48" Height="48" Margin="0,0,12,0">
                        <Ellipse.Fill>
                            <ImageBrush ImageSource="Assets/logo.png" Stretch="UniformToFill"/>
                        </Ellipse.Fill>
                    </Ellipse>
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="{Binding CurrentUser.DisplayName}" FontSize="14" FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding CurrentUser.Username}" FontSize="11" Foreground="{StaticResource Brush.TextSecondary}"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- Main Content Area -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Border Grid.Row="0" x:Name="TitleBar" Background="{StaticResource Brush.Background}" BorderBrush="{StaticResource Brush.Outline}" BorderThickness="0,0,0,1" Padding="24,0,24,0">
                <Grid>
                    <TextBlock Text="{Binding SelectedTab}" FontSize="24" FontWeight="Bold" VerticalAlignment="Center" Foreground="{StaticResource Brush.TextPrimary}"/>
                </Grid>
            </Border>

            <!-- Content Frame -->
            <Grid Grid.Row="1" Margin="24,24,24,32">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Banner -->
                <Border Grid.Row="0" Background="#1A2030" BorderBrush="{StaticResource Brush.Outline}" BorderThickness="1" CornerRadius="14" Padding="16" Margin="0,0,0,24" Visibility="Collapsed" x:Name="Banner">
                    <TextBlock Text="Welcome to Noturnal!" Foreground="{StaticResource Brush.TextSecondary}"/>
                </Border>

                <!-- Frame for Pages -->
                <Frame Grid.Row="1" x:Name="MainFrame" NavigationUIVisibility="Hidden"/>
            </Grid>
        </Grid>
    </Grid>
</Window>
