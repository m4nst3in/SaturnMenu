<Window x:Class="Noturnal.Loader.Views.CheatDetailsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:svc="clr-namespace:Noturnal.Loader.Services"
        Title="Cheat Details" Height="560" Width="600"
        WindowStartupLocation="CenterScreen" ResizeMode="NoResize"
        Background="#13141B" WindowStyle="None"
        Topmost="False" ShowInTaskbar="True" AllowsTransparency="False">

    <Window.Resources>
        <!-- Tema de cores e efeitos -->
        <SolidColorBrush x:Key="BackgroundBrush" Color="#13141B"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#181A22"/>
        <SolidColorBrush x:Key="CardBrush" Color="#191A21"/>
        <SolidColorBrush x:Key="OutlineBrush" Color="#292C32"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#E6E6E6"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#8B949E"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#A371F7"/>
        <LinearGradientBrush x:Key="TitleGradientBrush" StartPoint="0,0" EndPoint="1,0">
            <GradientStop Color="#A371F7" Offset="0"/>
            <GradientStop Color="#79C0FF" Offset="0.6"/>
            <GradientStop Color="#A371F7" Offset="1"/>
        </LinearGradientBrush>
        <DropShadowEffect x:Key="DropShadow" Color="#A371F7" BlurRadius="15" Opacity="0.16" ShadowDepth="0"/>
        <Style x:Key="CardBorder" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource OutlineBrush}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Effect" Value="{StaticResource DropShadow}" />
        </Style>
        <Style x:Key="AccentButton" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="{StaticResource TitleGradientBrush}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Padding" Value="18,8"/>
            <Setter Property="Height" Value="42"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="18" SnapsToDevicePixels="True" Effect="{StaticResource DropShadow}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,2,0,0"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.93"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Opacity" Value="0.85"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="GhostButton" TargetType="Button">
            <Setter Property="Foreground" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Background" Value="#161B22"/>
            <Setter Property="BorderBrush" Value="#3A4454"/>
            <Setter Property="BorderThickness" Value="1.4"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="Padding" Value="15,6"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="16" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#232c3b"/>
                                <Setter Property="BorderBrush" Value="#79C0FF"/>
                                <Setter Property="Foreground" Value="#79C0FF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Opacity" Value="0.85"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ConsoleListBox" TargetType="ListBox">
            <Setter Property="Background" Value="#181A22"/>
            <Setter Property="Foreground" Value="#E6E6E6"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="{StaticResource OutlineBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="54"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="22,8,0,8">
                    <Image Source="{Binding Cheat.Icon}" Width="32" Height="32" Margin="0,0,12,0" RenderOptions.BitmapScalingMode="HighQuality"/>
                    <TextBlock Text="Cheat Details" FontSize="28" FontWeight="Bold" Foreground="{StaticResource TitleGradientBrush}" VerticalAlignment="Center"/>
                </StackPanel>
                <Button Style="{StaticResource GhostButton}" Content="✕" FontSize="16"
                        Width="32" Height="32" Margin="0,0,18,0"
                        VerticalAlignment="Center" Click="Close_Click"
                        Grid.Column="1"/>
            </Grid>
        </Border>
        <Border Grid.Row="1" Style="{StaticResource CardBorder}" Padding="30,24" Margin="24,24,24,8">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBlock Text="Name:" FontSize="16" Foreground="{StaticResource TextSecondaryBrush}" Width="78"/>
                    <TextBlock Text="{Binding Cheat.Name}" FontSize="16" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="Medium"/>
                </StackPanel>
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,6">
                    <TextBlock Text="Expires:" FontSize="16" Foreground="{StaticResource TextSecondaryBrush}" Width="78"/>
                    <TextBlock Text="{Binding Cheat.Expiration, StringFormat={}{0:dd/MM/yyyy}}" FontSize="16" Foreground="{StaticResource AccentBrush}" FontWeight="Bold"/>
                </StackPanel>
                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,12,0,0">
                    <Button Style="{StaticResource AccentButton}" Content="Load" Click="LoadAll_Click" Width="120"/>
                    <Button Style="{StaticResource GhostButton}" Content="Copy expiration" Click="Copy_Click" Width="150" Margin="12,0,0,0"/>
                </StackPanel>
                <Rectangle Grid.Row="3" Height="1.5" Fill="{StaticResource OutlineBrush}" Margin="0,20,0,20"/>
                <Grid Grid.Row="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Text="Logs:" FontSize="15" Foreground="{StaticResource TextSecondaryBrush}" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <!-- BusyBar adicionado novamente -->
                    <ProgressBar x:Name="BusyBar" Grid.Row="1" IsIndeterminate="True" Visibility="Collapsed" Height="6" Margin="0,0,0,12"/>
                    <ListBox Grid.Row="2" MaxHeight="320" Style="{StaticResource ConsoleListBox}" ItemsSource="{Binding Entries, Source={x:Static svc:LogService.Instance}}" ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollBarVisibility="Auto">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Timestamp, StringFormat='[{0:HH:mm:ss}] '}" FontFamily="Consolas" FontSize="15" Foreground="{StaticResource AccentBrush}"/>
                                    <TextBlock Text="{Binding Message}" FontFamily="Consolas" FontSize="15" Foreground="{StaticResource TextPrimaryBrush}" TextWrapping="Wrap"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Grid>
        </Border>
        <!-- Barra de ações inferior corrigida, espaçamento via Margin -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,32,16">
            <Button Style="{StaticResource GhostButton}" Content="Export logs" Click="Export_Click" Width="130" Margin="0,0,12,0"/>
            <Button Style="{StaticResource AccentButton}" Content="Close" Click="Close_Click" Width="110"/>
        </StackPanel>
    </Grid>
</Window>
